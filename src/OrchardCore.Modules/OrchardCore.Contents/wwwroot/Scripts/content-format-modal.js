/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

// Run this function on document.ready
$(function () {
  var element = document.querySelector("#contentFormatModal");

  if (element) {
    var elementId = element.id;
    var searchUrl = element.dataset.searchUrl;
    var app = new Vue({
      el: '#' + elementId,
      data: function data() {
        var contentTypes = JSON.parse(element.dataset.types || "[]");
        return {
          listGroupClass: 'list-group-item list-group-item-action',
          activeClass: 'active',
          filter: '',
          allTypes: contentTypes,
          filteredTypes: contentTypes,
          contentFormat: '',
          selectedType: ''
        };
      },
      watch: {
        filter: function filter(_filter) {
          if (_filter) {
            var lower = _filter.toLowerCase();

            this.filteredTypes = this.allTypes.filter(function (s) {
              return s.key.toLowerCase().startsWith(lower);
            });
          } else {
            this.filteredTypes = this.allTypes;
          }
        }
      },
      mounted: function mounted() {
        var self = this;
        $(element).on('shown.bs.modal', function (e) {
          self.$refs.filter.focus();
        });
      },
      methods: {
        selectType: function selectType(type) {
          this.selectedType = type;
          var searchFullUrl = searchUrl + '?contentTypeName=' + type;
          var self = this;
          fetch(searchFullUrl).then(function (res) {
            res.json().then(function (json) {
              self.contentFormat = JSON.stringify(json, null, 1);
            });
          });
        }
      }
    });
  }
});